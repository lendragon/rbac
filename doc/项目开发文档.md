# 1、 系统设计

## 1） 流程图

http://192.168.42.193:8080/?lang=zh

![image-20231212150935176](images/image-20231212150935176.png)

## 2） E-R图

![image-20231212173046432](images/image-20231212173046432.png)

# 2、 表设计

用户表、角色表、菜单表、用户_角色关系表、角色\_菜单关系表



## 1） 用户表:

表名 : CT_Rbac_User

| 名称        | 字段类型     | 是否必填 | 描述           |
| ----------- | ------------ | -------- | -------------- |
| ID          | int(16)      | 是       | 主键,自增      |
| FNo         | varchar(30)  | 是       | 用户编号       |
| FName       | varchar(30)  | 是       | 用户名         |
| FPassword   | varchar(128) | 是       | 密码           |
| FSex        | int(12)      | 否       | 1\|男;2\|女;   |
| FBirthDay   | datetime     | 否       | 生日, 默认为空 |
| FPhoneNum   | varchar(30)  | 否       | 手机号         |
| FCreateTime | datetime     | 是       | 创建时间       |
| FUpdateTime | datetime     | 否       | 修改时间       |



## 2） 角色表:

表名: CT_Rbac_Role

| 名称         | 字段类型     | 是否必填 | 描述       |
| ------------ | ------------ | -------- | ---------- |
| ID           | int(16)      | 是       | 主键, 自增 |
| FName        | varchar(30)  | 是       | 角色名称   |
| FCreateTime  | datetime     | 是       | 创建时间   |
| FUpdateTime  | datetime     | 否       | 修改时间   |
| FDescription | varchar(255) | 否       | 角色描述   |



## 3） 菜单表:

表名: CT_Rbac_Menu

| 名称         | 字段类型     | 是否必填 | 描述         |
| ------------ | ------------ | -------- | ------------ |
| ID           | int(16)      | 是       | 主键, 自增   |
| FName        | varchar(30)  | 是       | 菜单名称     |
| FOrder       | int(12)      | 是       | 菜单显示顺序 |
| FLevel       | int(12)      | 是       | 菜单层级     |
| FParentID    | int(16)      | 否       | 父菜单ID     |
| FUrl         | varchar(255) | 否       | 菜单路径     |
| FCreateTime  | datetime     | 是       | 创建时间     |
| FUpdateTime  | datetime     | 否       | 修改时间     |
| FDescription | varchar(255) | 否       | 菜单描述     |



## 4） 用户_角色关系表:

表名: CT_Rbac_User_Role

| 名称    | 字段类型 | 是否必填 | 描述       |
| ------- | -------- | -------- | ---------- |
| ID      | int(16)  | 是       | 主键, 自增 |
| FUserID | int(16)  | 是       | 用户标识   |
| FRoleID | int(16)  | 是       | 角色标识   |



## 5） 角色_菜单关系表:

表名: CT_Rbac_Role_Menu

| 名称    | 字段类型 | 是否必填 | 描述       |
| ------- | -------- | -------- | ---------- |
| ID      | int(16)  | 是       | 主键, 自增 |
| FRoleID | int(16)  | 是       | 角色标识   |
| FMenuID | int(16)  | 是       | 菜单标识   |



# 3、 接口设计

## 1） 用户crud接口

### a) 查询用户

地址: **/livecloud/project/user.pagex?action=query**

方法: get

**inputs:** 

```json
"pageNo": int,		// 页码
"pageSize": int,	// 页长
"keyword": string	// 查询关键字
```

**outputs:**

```json
{
    "code": int,		// 识别码
    "success": boolean,	// 接口是否成功
    "msg": string,		// 消息
    "data": [
        {
            "ID": int,			// 用户ID
            "No": string,		// 用户编号
            "name": string,		// 用户名
            "password": string,	// 密码
            "sex": int,			// 性别
			"birthDay": Date,	// 生日
            "phoneNum": string,	// 手机号
            "createTime": Date,	// 创建时间
            "updateTime": Date	// 修改时间
        },
        ...
    ]
}
```



### b) 根据ID查询用户

地址: **/livecloud/project/user.pagex?action=queryById**

方法: get

**inputs:**

```json
"ID": int	// 用户标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": {
        "ID": int,			// 用户ID
        "No": string,		// 用户编号
        "name": string,		// 用户名
        "password": string,	// 密码
        "sex": int,			// 性别
        "birthDay": Date,	// 生日
        "phoneNum": string,	// 手机号
        "createTime": Date,	// 创建时间
        "updateTime": Date	// 修改时间
    }
}
```



### d) 新增用户

地址: **/livecloud/project/user.pagex?action=add**

方法: post

**inputs:**

```typescript
"FNo": string,		// 用户编号
"name": string,		// 用户名
"password": string,	// 密码
"phoneNum": string,	// 电话号码
"sex": int,			// 性别
"birthDay": Date,	// 生日
"phoneNum": string,	// 电话号码
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



### e) 修改用户

地址: **/livecloud/project/user.pagex?action=update**

方法: post

**inputs:**

```typescript
"ID": int,			// 用户标识
"FNo": string,		// 用户编号
"name": string,		// 用户名
"password": string,	// 密码
"phoneNum": string,	// 电话号码
"sex": int,			// 性别
"birthDay": Date,	// 生日
"phoneNum": string,	// 电话号码
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



### f) 删除用户

地址: **/livecloud/project/user.pagex?action=delete**

方法: post

**inputs:**

```typescript
"ID": int	// 用户标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



## 2） 角色crud接口

### a) 查询角色

地址: **/livecloud/project/role.pagex?action=query**

方法: get

**inputs:**

```json
"pageNo": int,		// 页码
"pageSize": int,	// 页长
"keyword": string	// 查询关键字
```



**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": [
        {
            "ID": int,				// 角色标识
            "name": string,			// 角色名
            "description": string,	// 角色描述
            "createTime": Date,		// 创建时间
            "updateTime": Date		// 修改时间
        },
        ...
    ]
}
```



### b) 新增角色

地址: **/livecloud/project/role.pagex?action=add**

方法: post

**inputs:**

```typescript
"name": string,			// 角色名
"description": string	// 角色描述
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



### d) 修改角色

地址: **/livecloud/project/role.pagex?action=update**

方法: post

**inputs:**

```typescript
"ID": int			// 角色标识
"name": string			// 角色名
"description": string	// 角色描述
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



### e) 删除角色

地址: **/livecloud/project/role.pagex?action=delete**

方法: post

**inputs:**

```typescript
"ID": int	// 角色标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



## 3） 菜单crud接口

### a) 查询菜单

地址: **/livecloud/project/menu.pagex?action=query**

方法: get

**inputs:**

```json
"pageNo": int,		// 页码
"pageSize": int,	// 页长
"keyword": string	// 查询关键字
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": [
        {
            "ID": string,			// 菜单标识
            "name": string,			// 菜单名
            "order": int,			// 菜单显示顺序
            "level": int,			// 菜单层级
            "parentID": int,		// 父菜单ID
            "Url": string,			// 菜单路径
            "createTime": Date,		// 创建时间
            "updateTime": Date,		// 修改时间
            "description": string,	// 菜单描述
        },
        ...
    ]
}
```



### b) 查询菜单树

地址: **/livecloud/project/menu.pagex?action=queryTree**

方法: get

**inputs:**

```json
"pageNo": int,		// 页码
"pageSize": int,	// 页长
"keyword": string	// 查询关键字
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": [
        {
            "ID": string,			// 菜单标识
            "name": string,			// 菜单名
            "order": int,			// 菜单显示顺序
            "level": int,			// 菜单层级
            "parentID": int,		// 父菜单ID
            "Url": string,			// 菜单路径
            "createTime": Date,		// 创建时间
            "updateTime": Date,		// 修改时间
            "description": string,	// 菜单描述
            "children": [
                {
                    "ID": string,			// 菜单标识
                    "name": string,			// 菜单名
                    "order": int,			// 菜单显示顺序
                    "level": int,			// 菜单层级
                    "parentID": int,		// 父菜单ID
                    "Url": string,			// 菜单路径
                    "createTime": Date,		// 创建时间
                    "updateTime": Date,		// 修改时间
                    "description": string,	// 菜单描述
                    "children": [
                        ...
                    ]
                },
                ...
            ]
        },
        ...
    ]
}
```





### c) 新增菜单

地址: **/livecloud/project/menu.pagex?action=add**

方法: post

**inputs:**

```typescript
"name": string,			// 菜单名
"order": int,			// 菜单显示顺序
"level": int,			// 菜单层级
"parentID": int,		// 父菜单ID
"Url": string,			// 菜单路径
"description": string	// 菜单描述
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



### d) 修改菜单

地址: **/livecloud/project/updateMenu.pagex**

方法: post

**inputs:**

```typescript
"ID": int				// 菜单标识
"name": string,			// 菜单名
"order": int,			// 菜单显示顺序
"level": int,			// 菜单层级
"parentID": int,		// 父菜单ID
"Url": string,			// 菜单路径
"description": string	// 菜单描述
```

**outputs:**

```json
{
    code: int,
    success: boolean,
    msg: string,
    data: null
}
```



### e) 删除菜单

地址: **/livecloud/project/deleteMenu.pagex**

方法: post

**inputs:**

```typescript
"ID": int	// 菜单标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



## 4） 用户关联角色接口

### a) 根据用户ID查询角色

地址: **/livecloud/project/userRole.pagex?action=queryByUserID**

方法: get

**inputs:**

```typescript
"userID": int		// 用户标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": {
        "ID": int,				// 角色标识
        "name": string,			// 角色名
        "description": string,	// 角色描述 
    }
}
```



### b) 新增用户的角色

地址: **/livecloud/project/userRole.pagex?action=add**

方法: post

**inputs:**

```typescript
"userID": int,	// 用户标识
"roleID": int[]	// 角色标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



### b) ~~修改用户的角色~~

地址: **/livecloud/project/userRole.pagex?action=update**

方法: post

**inputs:**

```typescript
"userID": int,	// 用户标识
"roleID": int[]	// 角色标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



### b) ~~删除用户的角色~~

地址: **/livecloud/project/userRole.pagex?action=delete**

方法: post

**inputs:**

```typescript
"userID": int,	// 用户标识
"roleID": int[]	// 角色标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```





## 5） 角色关联菜单接口

### a) 根据角色ID查询菜单

地址: **/livecloud/project/roleMenu.pagex?action=query**

方法: get

**inputs:**

```typescript
"roleID": int		// 角色标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": [
        {
            "ID": string,			// 菜单标识
            "name": string,			// 菜单名
            "order": int,			// 菜单显示顺序
            "level": int,			// 菜单层级
            "parentID": int,		// 父菜单ID
            "Url": string,			// 菜单路径
            "createTime": Date,		// 创建时间
            "updateTime": Date,		// 修改时间
            "description": string,	// 菜单描述
        },
        ...
    ]
}
```



### b) ~~角色新增菜单~~

地址: **/livecloud/project/roleMenu.pagex?action=add**

方法: post

**inputs:**

```typescript
"roleID": int		// 角色标识
"menuID": int[]		// 菜单标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```





### b) 修改角色的菜单

地址: **/livecloud/project/roleMenu.pagex?action=update**

方法: post

**inputs:**

```typescript
"roleID": int		// 角色标识
"menuID": int[]		// 菜单标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



### d) ~~角色删除菜单~~

地址: **/livecloud/project/roleMenu.pagex?action=delete**

方法: post

**inputs:**

```typescript
"roleID": int		// 角色标识
"menuID": int[]		// 菜单标识
```

**outputs:**

```json
{
    "code": int,
    "success": boolean,
    "msg": string,
    "data": null
}
```



# 4、 页面设计

## 1） 用户列表

## 2） 角色列表

## 3） 菜单列表